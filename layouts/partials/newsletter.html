<style>
	button:disabled {
		cursor: not-allowed;
		opacity: 0.5;
	}
</style>
<div class="py-4 border-b">
	<form x-data="contactForm()" x-cloak @submit.prevent="submitData" class="container ">
		<div class="flex flex-col py-4 md:w-1/2">
			<label class="font-bold entry__label" for="EMAIL" data-required="*" x-text="heading">
				Sign up for our newsletter
			</label>
			<div class="mt-2 flex" x-show="!success">
				<input x-model="formData.EMAIL"
					class="w-2/3 rounded-l-lg p-4 border-t mr-0 border-b border-l text-gray-800 border-gray-200 bg-white"
					type="text" id="EMAIL" name="EMAIL" autocomplete="off" placeholder="Your email address"
					data-required="true" required />

				<button x-text="buttonLabel" :disabled="loading"
					class="w-1/3 text-sm lg:text-base hover:bg-gray-800 lg:px-8 rounded-r-lg bg-primary-900 disabled:opacity-50 text-gray-200 font-bold p-1 md:p-4 uppercase border-yellow-500 border-t border-b border-r focus:border-gray-100">
					Subscribe
				</button>
			</div>
			<label x-html="message" :class="{'text-red-600': !success, 'text-green-600': success}" class="mt-1 text-xs">
			</label>
			<label class="mt-1 text-xs text-gray-600">
				You may unsubscribe at any time using the link in our newsletter.
			</label>
		</div>
		<input type="text" name="email_address_check" value="" class="hidden">
		<input type="hidden" name="locale" value="en">
	</form>
</div>

<script>
	var AUTOHIDE = Boolean(0);
	var address = "https://9db6e0e9.sibforms.com/serve/MUIEAJmJNqSsyZPUM0hlB_dFYKaFE8ULnReQy1JzNyhul5dgJ40AvclwkAlIf0eWFTGpppA53pmErTw9Vt_xLzr29fBkcwYqXnvxYwKbZdDSh0kXPR4Dyvj7OMRh3ateaTYxQ-55RTOAfedWZ38osSogsHcMMEE7Dm9O8fikAeYRYhB35Yy5OipXW1aTQZtFPj79uYOIZDA9CxGD?isAjax=1"

	function contactForm() {
		return {
			formData: {
				EMAIL: '',
				email_address_check: '',
				locale: 'en'
			},
			message: '',
			success: null,
			loading: false,
			buttonLabel: 'Subscribe',
			heading: 'Sign up for our newsletter',
			submitData() {
				this.message = ''
				this.buttonLabel = 'Subscribe'
				this.loading = true;
				let formData = new FormData();
				formData.append('EMAIL', this.formData.EMAIL);
				formData.append('email_address_check', this.formData.email_address_check);
				formData.append('locale', this.formData.locale);
				formData.append('OPT_IN', this.formData.locale);
				fetch(address, {
					method: 'post',
					mode: 'cors',
					body: formData
				}).then(response => response.json())
					.then(data => {
						if (data.success) {
							this.success = true
							this.message = data.message
							this.heading = "Thanks for signing up!"
						} else {
							this.success = false
							this.message = data.errors.EMAIL
						}
						this.loading = false;
						this.buttonLabel = 'Subscribe'

					}).catch((err) => {
						this.success = false
						this.message = 'Ooops! Something went wrong!'
						this.loading = false;
						this.buttonLabel = 'Subscribe'
					});
			}
		}
	}
</script>
{{/*
<script src="https://sibforms.com/forms/end-form/build/main.js"></script> */}}
{{/*
<script src="https://www.google.com/recaptcha/api.js?hl=en"></script> */}}
